(()=>{"use strict";class e{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorSelector=e.errorSelector,this._errorClass=e.errorClass,this._form=t,this._button=t.querySelector(this._submitButtonSelector),this._inputList=t.querySelectorAll(this._inputSelector)}_showInputError(e,t){t.classList.add(this._inputErrorClass),e.textContent=t.validationMessage}_hideInputError(e,t){t.classList.remove(this._inputErrorClass),e.textContent=""}_checkInputValidity(e){const t=this._form.querySelector(`${this._errorSelector}${e.name}`);e.validity.valid?this._hideInputError(t,e):this._showInputError(t,e)}_disableButton(){this._button.classList.add(this._inactiveButtonClass),this._button.disabled=!0}_enableButton(){this._button.classList.remove(this._inactiveButtonClass),this._button.disabled=!1}_hasValidInput(){return Array.from(this._inputList).every((e=>e.validity.valid))}_toggleButtonState(){this._hasValidInput()?this._enableButton():this._disableButton(this._button)}_setEventListener(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._setEventListener()}resetValidation(){this._inputList.forEach((e=>{const t=this._form.querySelector(`${this._errorSelector}${e.name}`);e.validity.valid||this._hideInputError(t,e)})),this._disableButton()}}class t{constructor(e){this._popup=document.querySelector(e),this._popupCloseButton=this._popup.querySelector(".popup__close")}_handleEscClose=e=>{"Escape"===e.key&&this.close()};_handleCloseButton=()=>{this.close()};_closePopupByClickOnOverlay=e=>{e.target===e.currentTarget&&this.close()};setEventListeners(){this._popupCloseButton.addEventListener("click",this._handleCloseButton),this._popup.addEventListener("click",this._closePopupByClickOnOverlay)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}}class s extends t{constructor(e,t){super(e),this._submitFormCallback=t,this._form=this._popup.querySelector(".popup__form"),this._inputList=this._form.querySelectorAll(".popup__input")}getInputsValue(){return this._values={},this._inputList.forEach((e=>{this._values[e.name]=e.value})),this._values}setInputsValue(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._submitFormCallback(this.getInputsValue())}))}close(){super.close(),this._form.reset()}}class i{constructor(e,t,s){this._imageData=e,this._link=e.link,this._name=e.title,this._selectorTemplate=t,this._openImagePopup=s,this._cloneElement=document.querySelector(this._selectorTemplate).content.querySelector(".group__item").cloneNode(!0),this._imageElement=this._cloneElement.querySelector(".group__mask"),this._likeElement=this._cloneElement.querySelector(".group__like"),this._trashElement=this._cloneElement.querySelector(".group__trash"),this._picTitle=this._cloneElement.querySelector(".group__picture-name")}_toggleLike=()=>{this._likeElement.classList.toggle("group__like_active")};_handleTrashSignClick=()=>{this._cloneElement.remove(),this._cloneElement=null};_handleImageClick=()=>{this._openImagePopup(this._imageData)};_setEventListener(){this._likeElement.addEventListener("click",this._toggleLike),this._trashElement.addEventListener("click",this._handleTrashSignClick),this._imageElement.addEventListener("click",this._handleImageClick)}createCard(){return this._imageElement.src=this._link,this._imageElement.alt=`Фотография ${this._name}`,this._picTitle.textContent=this._name,this._setEventListener(),this._cloneElement}}const o=document.querySelector(".profile__edit-button"),n=document.querySelector(".profile__add-button"),r={inputSelector:".popup__input",submitButtonSelector:".popup__button-save",inactiveButtonClass:"popup__button-save_disable",inputErrorClass:"popup__input_invalid",errorSelector:".popup__error_type_",errorClass:"popup__error_active"},l=document.forms["Profile-edit-form"],a=document.forms["Card-add-form"],p=new class{constructor(e){this._nameProfile=document.querySelector(e.nameProfileSelector),this._jobProfile=document.querySelector(e.jobProfileSelector)}getUserInfo(){return{username:this._nameProfile.textContent,job:this._jobProfile.textContent}}setUserInfo(e){this._nameProfile.textContent=e.username,this._jobProfile.textContent=e.job}}({nameProfileSelector:".profile__name",jobProfileSelector:".profile__job"}),c=new class extends t{constructor(e){super(e),this._popupImage=this._popup.querySelector(".popup__picture"),this._imagePopupCaption=this._popup.querySelector(".popup__caption")}open=e=>{console.log(e),this._popupImage.src=e.link,this._popupImage.alt=`Фотография ${e.title}`,this._imagePopupCaption.textContent=e.title,super.open()}}(".popup_type_image");c.setEventListeners();const _=new class{constructor(e,t){let{items:s,renderer:i}=e;this._container=document.querySelector(t),this._initialCard=s,this._renderer=i}renderItems(){this._initialCard.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:[{title:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"},{title:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{title:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{title:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{title:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{title:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"}],renderer:e=>{_.addItem(u(e))}},".group"),u=e=>new i(e,"#theCard",c.open).createCard();_.renderItems();const h=new s(".popup_type_profile",(e=>{p.setUserInfo(e),h.close()}));h.setEventListeners();const d=new s(".popup_type_cards",(e=>{_.addItem(u(e)),d.close()}));d.setEventListeners();const m=new e(r,l);m.enableValidation();const v=new e(r,a);v.enableValidation(),o.addEventListener("click",(()=>{m.resetValidation(),h.setInputsValue(p.getUserInfo()),h.open()})),n.addEventListener("click",(()=>{v.resetValidation(),d.open()}))})();